"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6326],{6326:(C,b,d)=>{d.r(b),d.d(b,{DashboardPageModule:()=>Z});var g=d(6895),h=d(4719),r=d(191),u=d(5181),p=d(5861),e=d(4650),m=d(2796),_=d(1056);function f(t,c){if(1&t){const n=e.EpF();e.TgZ(0,"ion-item")(1,"ion-searchbar",9),e.NdJ("ngModelChange",function(s){e.CHM(n);const o=e.oxw();return e.KtG(o.searchInput=s)})("keyup",function(){e.CHM(n);const s=e.oxw();return e.KtG(s.searchBusiness(s.searchInput))}),e.qZA()()}if(2&t){const n=e.oxw();e.xp6(1),e.Q6J("ngModel",n.searchInput)}}function v(t,c){if(1&t&&(e.TgZ(0,"ion-card")(1,"ion-row")(2,"ion-col",11),e._uU(3),e.qZA(),e.TgZ(4,"ion-col",12),e._uU(5),e.qZA()(),e.TgZ(6,"ion-row")(7,"ion-col"),e._uU(8,"Issued Date"),e.qZA(),e.TgZ(9,"ion-col"),e._uU(10),e.qZA()(),e.TgZ(11,"ion-row")(12,"ion-col"),e._uU(13,"Qc Status"),e.qZA(),e.TgZ(14,"ion-col"),e._uU(15),e.qZA()()()),2&t){const n=c.$implicit;e.xp6(3),e.Oqu(n.name),e.xp6(2),e.hij("\u20b9 ",n.disbursedAmount,""),e.xp6(5),e.Oqu(n.disburseDate),e.xp6(5),e.Oqu("A"==n.approvedbyadmin?"Approved":"R"==n.approvedbyadmin?"Rejected":"H"==n.approvedbyadmin?"Hold":"Pending")}}function P(t,c){if(1&t&&(e.TgZ(0,"div"),e.YNc(1,v,16,4,"ion-card",10),e.qZA()),2&t){const n=e.oxw();e.xp6(1),e.Q6J("ngForOf",n.top5Records)}}const M=[{path:"",component:(()=>{class t{constructor(n,a,s){this.router=n,this.firestore=a,this.commondataService=s,this.yearValues=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30],this.dashboard={},this.top5Records=[],this.top5=!0,this.downloaddata=[],this.dashboard.totalredeem="0",this.dashboard.invalidcases="0",this.dashboard.totalcases="0",this.dashboard.totalpaid="0",this.dashboard.totalpending="0",this.userRole=JSON.parse(localStorage.userData).role,"agent"==this.userRole?(this.top5=!0,this.firestore.collection("business",o=>o.where("agent","==",JSON.parse(localStorage.userData).email).limit(5)).get().subscribe(o=>{console.log("Top 5 docs here"),console.log(o),o.docs.forEach(i=>{console.log(i.data());var l=i.data();console.log(l),l.id=i.id,this.top5Records.push(l)})}),console.log(this.commondataService.allPendingBusiness),this.firestore.collection("business",o=>o.where("agent","==",JSON.parse(localStorage.userData).email)).get().subscribe(o=>{console.log("all docs here"),console.log(o),this.dashboard.totalcases=o.docs.length,o.docs.forEach(i=>{console.log(i.data());var l=i.data();console.log(l),l.id=i.id,this.commondataService.allPendingBusiness.push(l)})}),console.log(this.commondataService.allPendingBusiness),this.firestore.collection("business",o=>o.where("agent","==",JSON.parse(localStorage.userData).email).where("approvedbyadmin","==","R")).get().subscribe(o=>{console.log("all docs here"),console.log(o),this.dashboard.invalidcases=o.docs.length,o.docs.forEach(i=>{console.log(i.data());var l=i.data();console.log(l),l.id=i.id,this.commondataService.allInvalidBusiness.push(l)})}),console.log(this.commondataService.allInvalidBusiness)):(this.top5=!1,this.firestore.collection("business",o=>o.where("createdBy","==",JSON.parse(localStorage.userData).email)).get().subscribe(o=>{console.log("all docs here"),console.log(o),this.dashboard.totalcases=o.docs.length,o.docs.forEach(i=>{console.log(i.data());var l=i.data();console.log(l),l.id=i.id,this.commondataService.allPendingBusiness.push(l)})}),console.log(this.commondataService.allPendingBusiness),this.firestore.collection("business",o=>o.where("createdBy","==",JSON.parse(localStorage.userData).email).where("approvedbyadmin","==","R")).get().subscribe(o=>{console.log("all docs here"),console.log(o),this.dashboard.invalidcases=o.docs.length,o.docs.forEach(i=>{console.log(i.data());var l=i.data();console.log(l),l.id=i.id,this.commondataService.allInvalidBusiness.push(l)})}),console.log(this.commondataService.allInvalidBusiness))}goto(n){this.router.navigate([n])}searchBusiness(n){console.log(n),this.businessRef=this.firestore.collection("business"),this.firestore.collection("business",a=>a.where("name","==",n).where("lanNo","==",n).where("createdBy","==",n)).get().subscribe(a=>{console.log(a.data())})}ngOnInit(){}exportReport(){var n=this;return(0,p.Z)(function*(){yield n.firestore.collection("business").get().subscribe(a=>{console.log(a.docs),n.reportData=a.docs,n.reportData.forEach(o=>{n.downloaddata.push({name:o.name,lanNo:o.lanNo,createdBy:o.createdBy,createdByName:o.createdByName,disbursedAmount:o.disbursedAmount,disburseDate:o.disburseDate})});const s=n.objectToCsv(n.downloaddata);console.log(s),n.download(s)})})()}objectToCsv(n){if(0!=n.length){const a=[],s=Object.keys(n[0]);a.push(s.join(","));for(const o of n){const i=s.map(l=>`"${(""+o[l]).replace(/"/g,'\\"')}"`);a.push(i.join(","))}return a.join("\n")}alert("No Data Found")}download(n){console.log(n);const a=new Blob([n],{type:"text/csv"}),s=window.URL.createObjectURL(a),o=document.createElement("a");o.setAttribute("hidden",""),o.setAttribute("href",s),o.setAttribute("download","download.csv"),document.body.appendChild(o),o.click(),document.body.removeChild(o)}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(u.F0),e.Y36(m.ST),e.Y36(_.Y))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-dashboard"]],decls:32,vars:6,consts:[[1,"header-color"],["slot","start"],[2,"margin","15%"],[2,"text-align","center"],["readonly","",3,"ngModel","ngModelChange"],["readonly","",3,"ngModel","click","ngModelChange"],[4,"ngIf"],[1,"btnStyle"],[3,"click"],["placeholder","Enter LAN Number",3,"ngModel","ngModelChange","keyup"],[4,"ngFor","ngForOf"],["size","8"],["size","4"]],template:function(n,a){1&n&&(e.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),e._UZ(3,"ion-back-button"),e.qZA(),e.TgZ(4,"ion-title"),e._uU(5,"Dashboard"),e.qZA()()(),e.TgZ(6,"ion-content")(7,"ion-grid",2)(8,"ion-row",3)(9,"ion-col")(10,"ion-label"),e._uU(11,"Total Paid Points"),e.qZA(),e.TgZ(12,"ion-input",4),e.NdJ("ngModelChange",function(o){return a.dashboard.totalpaid=o}),e.qZA()(),e.TgZ(13,"ion-col")(14,"ion-label"),e._uU(15,"Total Points Pending"),e.qZA(),e.TgZ(16,"ion-input",4),e.NdJ("ngModelChange",function(o){return a.dashboard.totalpending=o}),e.qZA()()(),e.TgZ(17,"ion-row",3)(18,"ion-col")(19,"ion-label"),e._uU(20,"Total Number of Cases"),e.qZA(),e.TgZ(21,"ion-input",5),e.NdJ("click",function(){return a.goto("totalcases")})("ngModelChange",function(o){return a.dashboard.totalcases=o}),e.qZA()(),e.TgZ(22,"ion-col")(23,"ion-label"),e._uU(24,"Total Invalid Cases"),e.qZA(),e.TgZ(25,"ion-input",5),e.NdJ("click",function(){return a.goto("invalidcases")})("ngModelChange",function(o){return a.dashboard.invalidcases=o}),e.qZA()()()(),e.YNc(26,f,2,1,"ion-item",6),e._UZ(27,"div"),e.YNc(28,P,2,1,"div",6),e.TgZ(29,"div",7)(30,"ion-button",8),e.NdJ("click",function(){return a.exportReport()}),e._uU(31,"Export to Exel"),e.qZA()()()),2&n&&(e.xp6(12),e.Q6J("ngModel",a.dashboard.totalpaid),e.xp6(4),e.Q6J("ngModel",a.dashboard.totalpending),e.xp6(5),e.Q6J("ngModel",a.dashboard.totalcases),e.xp6(4),e.Q6J("ngModel",a.dashboard.invalidcases),e.xp6(1),e.Q6J("ngIf","agent"==a.userRole&&1==a.top5),e.xp6(2),e.Q6J("ngIf","agent"==a.userRole&&1==a.top5))},dependencies:[g.sg,g.O5,h.JJ,h.On,r.oU,r.YG,r.Sm,r.PM,r.wI,r.W2,r.jY,r.Gu,r.pK,r.Ie,r.Q$,r.Nd,r.VI,r.wd,r.sr,r.j9,r.cs],styles:[".ion-margin[_ngcontent-%COMP%]{--ion-grid-column-padding: 10px;border-collapse:collapse;border-style:hidden}.ion-margin[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]:first-child{font-weight:700}.ion-margin[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{border:1px solid black;border-bottom:0;border-right:0}.ion-margin[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]:last-child{border-right:1px solid black}.ion-margin[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]:last-child{border-bottom:1px solid black}.btnStyle[_ngcontent-%COMP%]{text-align:center}.btnStyleIn[_ngcontent-%COMP%]{--border-radius: 50%}"]}),t})()}];let T=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[u.Bz.forChild(M),u.Bz]}),t})(),Z=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[g.ez,h.u5,r.Pc,T]}),t})()}}]);