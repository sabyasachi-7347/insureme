"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7378],{7378:(w,A,c)=>{c.r(A),c.d(A,{PayoutallbusinessPageModule:()=>U});var y=c(6895),p=c(4719),l=c(191),d=c(5181),m=c(5861),e=c(4650),P=c(2796);function b(o,r){if(1&o&&(e.TgZ(0,"ion-col"),e._uU(1),e.qZA()),2&o){const n=e.oxw().$implicit;e.xp6(1),e.hij(" ",n.amountToPayAgent," ")}}function T(o,r){if(1&o&&(e.TgZ(0,"ion-col"),e._uU(1),e.qZA()),2&o){const n=e.oxw().$implicit;e.xp6(1),e.hij(" ",n.amountToPaySubAgent," ")}}function Z(o,r){if(1&o){const n=e.EpF();e.TgZ(0,"ion-row")(1,"ion-col")(2,"ion-checkbox",4),e.NdJ("ionChange",function(i){const h=e.CHM(n).$implicit,f=e.oxw();return e.KtG(f.updateCheckedOptions(h.id,h,i))}),e.qZA()(),e.TgZ(3,"ion-col"),e._uU(4),e.qZA(),e.YNc(5,b,2,1,"ion-col",5),e.YNc(6,T,2,1,"ion-col",5),e.qZA()}if(2&o){const n=r.$implicit,a=e.oxw();e.xp6(2),e.Q6J("checked",a.selectedCategory.indexOf(n.id)>=0),e.xp6(2),e.hij(" ",n.name," "),e.xp6(1),e.Q6J("ngIf","agent"==a.selection),e.xp6(1),e.Q6J("ngIf","agent"!=a.selection)}}const C=[{path:"",component:(()=>{class o{constructor(n,a,i){var t=this;this.route=n,this.router=a,this.firestore=i,this.allAgentBusiness=[],this.selectedCategory=[],this.route.queryParams.subscribe(function(){var h=(0,m.Z)(function*(f){t.router.getCurrentNavigation().extras.state&&(t.agentDetails=t.router.getCurrentNavigation().extras.state,t.selection=t.agentDetails.selection,t.allAgentBusiness=[],t.totalAmount=0,"agent"==t.selection?yield t.firestore.collection("business",g=>g.where("approvedbyadmin","==","A").where("agent","==",t.agentDetails.email)).get().subscribe(g=>{console.log(g),g.docs.forEach(u=>{console.log(u.data());var s=u.data();s.isChecked=!0,s.id=u.id,s.amountToPayAgent=s.amountToPayAgent?s.amountToPayAgent:0,"true"!=s.agentPaid||null==s.agentPaid?(t.totalAmount=t.totalAmount+s.amountToPayAgent,t.allAgentBusiness.push(s)):console.log("already paid")}),console.log(t.allAgentBusiness),t.selectedCategory=[];for(let u=0;u<t.allAgentBusiness.length;u++)t.selectedCategory.push(t.allAgentBusiness[u].id)}):yield t.firestore.collection("business",g=>g.where("approvedbyadmin","==","A").where("createdBy","==",t.agentDetails.email)).get().subscribe(g=>{console.log(g),g.docs.forEach(u=>{console.log(u.data());var s=u.data();s.isChecked=!0,s.id=u.id,s.amountToPaySubAgent=s.amountToPaySubAgent?s.amountToPaySubAgent:0,"true"!=s.subAgentPaid||null==s.subAgentPaid?(t.totalAmount=t.totalAmount+s.amountToPaySubAgent,t.allAgentBusiness.push(s)):console.log("already paid")}),console.log(t.allAgentBusiness),t.selectedCategory=[];for(let u=0;u<t.allAgentBusiness.length;u++)t.selectedCategory.push(t.allAgentBusiness[u].id)}))});return function(f){return h.apply(this,arguments)}}())}ngOnInit(){return(0,m.Z)(function*(){})()}updateCheckedOptions(n,a){let i=this.selectedCategory.indexOf(n);"agent"==this.selection?i>-1?(this.selectedCategory.splice(i,1),this.totalAmount=this.totalAmount-a.amountToPayAgent):(this.selectedCategory.push(n),this.totalAmount=this.totalAmount+a.amountToPayAgent):i>-1?(this.selectedCategory.splice(i,1),this.totalAmount=this.totalAmount-a.amountToPaySubAgent):(this.selectedCategory.push(n),this.totalAmount=this.totalAmount+a.amountToPaySubAgent),console.dir(this.selectedCategory)}markPayment(){var n=this;"agent"==this.selection?(this.selectedCategory.forEach(function(){var a=(0,m.Z)(function*(i){console.log(i),yield n.firestore.collection("business").doc(i).update({agentPaid:"true",agentPayDate:(new Date).getUTCFullYear()+""+(new Date).getUTCMonth()+(new Date).getUTCDate()}).catch(t=>{console.log(t),alert("Unable to process request")}).then(t=>{console.log(t)})});return function(i){return a.apply(this,arguments)}}()),this.router.navigate(["adminmonthlypayouts"])):(this.selectedCategory.forEach(function(){var a=(0,m.Z)(function*(i){console.log(i),yield n.firestore.collection("business").doc(i).update({subAgentPaid:"true",subAgentPayDate:(new Date).getUTCFullYear()+""+(new Date).getUTCMonth()+(new Date).getUTCDate()}).catch(t=>{console.log(t),alert("Unable to process request")}).then(t=>{console.log(t)})});return function(i){return a.apply(this,arguments)}}()),this.router.navigate(["adminmonthlypayouts"]))}}return o.\u0275fac=function(n){return new(n||o)(e.Y36(d.gz),e.Y36(d.F0),e.Y36(P.ST))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-payoutallbusiness"]],decls:43,vars:7,consts:[[1,"header-color"],["slot","start"],[4,"ngFor","ngForOf"],["expand","full",3,"click"],[3,"checked","ionChange"],[4,"ngIf"]],template:function(n,a){1&n&&(e.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),e._UZ(3,"ion-back-button"),e.qZA(),e.TgZ(4,"ion-title"),e._uU(5,"Payment Confirmation"),e.qZA()()(),e.TgZ(6,"ion-content")(7,"ion-row")(8,"ion-col"),e._uU(9,"Name :"),e.qZA(),e.TgZ(10,"ion-col"),e._uU(11),e.qZA()(),e.TgZ(12,"ion-row")(13,"ion-col"),e._uU(14,"Bank :"),e.qZA(),e.TgZ(15,"ion-col"),e._uU(16),e.qZA()(),e.TgZ(17,"ion-row")(18,"ion-col"),e._uU(19,"Beneficiary :"),e.qZA(),e.TgZ(20,"ion-col"),e._uU(21),e.qZA()(),e.TgZ(22,"ion-row")(23,"ion-col"),e._uU(24,"IFSC :"),e.qZA(),e.TgZ(25,"ion-col"),e._uU(26),e.qZA()(),e.TgZ(27,"ion-row")(28,"ion-col"),e._uU(29,"Account Number :"),e.qZA(),e.TgZ(30,"ion-col"),e._uU(31),e.qZA()(),e.TgZ(32,"ion-grid")(33,"ion-row"),e._UZ(34,"ion-col"),e.TgZ(35,"ion-col"),e._uU(36," Business Name "),e.qZA(),e.TgZ(37,"ion-col"),e._uU(38," Payable Amount "),e.qZA()(),e.YNc(39,Z,7,4,"ion-row",2),e.qZA()(),e.TgZ(40,"ion-footer")(41,"ion-button",3),e.NdJ("click",function(){return a.markPayment()}),e._uU(42),e.qZA()()),2&n&&(e.xp6(11),e.Oqu(a.agentDetails.name),e.xp6(5),e.Oqu(a.agentDetails.bankname),e.xp6(5),e.Oqu(a.agentDetails.beneficiary),e.xp6(5),e.Oqu(a.agentDetails.ifsc),e.xp6(5),e.Oqu(a.agentDetails.acno),e.xp6(8),e.Q6J("ngForOf",a.allAgentBusiness),e.xp6(3),e.hij("Mark Payment ",a.totalAmount," As Paid"))},dependencies:[y.sg,y.O5,l.oU,l.YG,l.Sm,l.nz,l.wI,l.W2,l.fr,l.jY,l.Gu,l.Nd,l.wd,l.sr,l.w,l.cs]}),o})()}];let _=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[d.Bz.forChild(C),d.Bz]}),o})(),U=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[y.ez,p.u5,l.Pc,_]}),o})()}}]);