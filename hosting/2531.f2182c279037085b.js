"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2531],{2531:(A,g,r)=>{r.r(g),r.d(g,{SalesdataPageModule:()=>P});var c=r(6895),d=r(4719),s=r(191),u=r(5181),p=r(5861),e=r(4650),h=r(2796);function m(a,l){if(1&a&&(e.TgZ(0,"ion-select-option",11),e._uU(1),e.qZA()),2&a){const t=l.$implicit;e.xp6(1),e.Oqu(t)}}function b(a,l){if(1&a&&(e.TgZ(0,"ion-card")(1,"ion-row")(2,"ion-col",13),e._uU(3),e.qZA()(),e.TgZ(4,"ion-row")(5,"ion-col",14),e._uU(6),e.qZA(),e.TgZ(7,"ion-col",14),e._uU(8),e.qZA()(),e.TgZ(9,"ion-row")(10,"ion-col",14),e._uU(11),e.qZA(),e.TgZ(12,"ion-col",14),e._uU(13),e.qZA()(),e.TgZ(14,"ion-row")(15,"ion-col",13),e._uU(16),e.qZA()()()),2&a){const t=l.$implicit;e.xp6(3),e.hij(" ",t.name," "),e.xp6(3),e.hij(" LAN: ",t.lanNo," "),e.xp6(2),e.hij(" Created By: ",t.createdBy," "),e.xp6(3),e.hij(" Amount: ",t.disbursedAmount," "),e.xp6(2),e.hij(" Type: ",t.typeOfBorrow," "),e.xp6(3),e.hij(" Remark: ",t.remarks," ")}}function S(a,l){if(1&a&&(e.TgZ(0,"ion-grid"),e.YNc(1,b,17,6,"ion-card",12),e.qZA()),2&a){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.allbusiness)}}const f=[{path:"",component:(()=>{class a{constructor(t,o){this.firestore=t,this.router=o,this.downloaddata=[],this.years=[],this.allbusiness=[],this.allBusinessSearch=[],this.selectedDate="",this.inputLanNo="",this.custName="",this.inputSearch=""}ngOnInit(){}ionViewWillEnter(){var t=this;return(0,p.Z)(function*(){yield t.firestore.collection("dropdown").doc("yearmonth").get().subscribe(o=>{console.log(o.data().yearmonth),t.years=o.data().yearmonth}),t.allbusiness=[],"subagent"==JSON.parse(localStorage.userData).role?yield t.firestore.collection("business",o=>o.where("createdBy","==",JSON.parse(localStorage.userData).email)).get().subscribe(o=>{console.log("all docs here"),console.log(o),o.docs.forEach(n=>{console.log(n.data());var i=n.data();console.log(i),i.id=n.id,t.allbusiness.push(i),t.allBusinessSearch.push(i)})}):yield t.firestore.collection("business",o=>o.where("agent","==",JSON.parse(localStorage.userData).email)).get().subscribe(o=>{console.log("all docs here"),console.log(o),o.docs.forEach(n=>{console.log(n.data());var i=n.data();console.log(i),i.id=n.id,t.allbusiness.push(i),t.allBusinessSearch.push(i)})})})()}searchBusiness(){this.allbusiness=this.allBusinessSearch.filter(t=>t.name.toString().includes(this.inputSearch)||t.lanNo.toString().includes(this.inputSearch.toString())?t:void 0)}exportReport(){var t=this;return(0,p.Z)(function*(){t.allbusiness.forEach(n=>{t.downloaddata.push({"Business Name":n.name?n.name:"","Lan Number":n.lanNo?n.lanNo:"","Created By Email":n.createdBy?n.createdBy:"","Created By Name":n.createdByName?n.createdByName:"","Disbused Amount":n.disbursedAmount?n.disbursedAmount:"","Disbused Date":n.disburseDate?n.disburseDate:"","QC Status":"R"==n.approvedbyadmin?"Reject":"P"==n.approvedbyadmin?"Pending":"H"==n.approvedbyadmin?"Hold":"Paid"==n.approvedbyadmin?"Paid":"NA","Agent Paymet":n.amountToPayAgent?n.amountToPayAgent:"","Sub Agent Payment":n.amountToPaySubAgent?n.amountToPaySubAgent:""})});const o=t.objectToCsv(t.downloaddata);console.log(o),t.download(o)})()}objectToCsv(t){if(0!=t.length){const o=[],n=Object.keys(t[0]);o.push(n.join(","));for(const i of t){const _=n.map(Z=>`"${(""+i[Z]).replace(/"/g,'\\"')}"`);o.push(_.join(","))}return o.join("\n")}alert("No Data Found")}download(t){console.log(t);const o=new Blob([t],{type:"text/csv"}),n=window.URL.createObjectURL(o),i=document.createElement("a");i.setAttribute("hidden",""),i.setAttribute("href",n),i.setAttribute("download","download.csv"),document.body.appendChild(i),i.click(),document.body.removeChild(i)}}return a.\u0275fac=function(t){return new(t||a)(e.Y36(h.ST),e.Y36(u.F0))},a.\u0275cmp=e.Xpm({type:a,selectors:[["app-salesdata"]],decls:31,vars:4,consts:[[1,"header-color"],["slot","start"],["position","floating"],["placeholder","Select date",3,"ngModel","ngModelChange"],["value",""],["value","year",4,"ngFor","ngForOf"],[3,"ngModel","ngModelChange"],[1,"btnStyle"],[1,"btnStyleIn",3,"click"],[4,"ngIf"],[3,"click"],["value","year"],[4,"ngFor","ngForOf"],[2,"text-align","center"],["size","6",2,"text-align","center"]],template:function(t,o){1&t&&(e.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-buttons",1),e._UZ(3,"ion-back-button"),e.qZA(),e.TgZ(4,"ion-title"),e._uU(5,"Sales Data"),e.qZA()()(),e.TgZ(6,"ion-content")(7,"ion-item")(8,"ion-label",2),e._uU(9,"Select Date"),e.qZA(),e.TgZ(10,"ion-select",3),e.NdJ("ngModelChange",function(i){return o.selectedDate=i}),e.TgZ(11,"ion-select-option",4),e._uU(12,"Select Date"),e.qZA(),e.YNc(13,m,2,1,"ion-select-option",5),e.qZA()(),e._UZ(14,"br"),e.TgZ(15,"ion-grid")(16,"ion-row")(17,"ion-col")(18,"ion-item")(19,"ion-label"),e._uU(20,"LAN ID Number Or Customer Name"),e.qZA()()(),e.TgZ(21,"ion-col")(22,"ion-item")(23,"ion-input",6),e.NdJ("ngModelChange",function(i){return o.inputSearch=i}),e.qZA()()()(),e.TgZ(24,"div",7)(25,"ion-button",8),e.NdJ("click",function(){return o.searchBusiness()}),e._uU(26,"Search"),e.qZA()()(),e.YNc(27,S,2,1,"ion-grid",9),e.TgZ(28,"div",7)(29,"ion-button",10),e.NdJ("click",function(){return o.exportReport()}),e._uU(30,"Export to Exel"),e.qZA()()()),2&t&&(e.xp6(10),e.Q6J("ngModel",o.selectedDate),e.xp6(3),e.Q6J("ngForOf",o.years),e.xp6(10),e.Q6J("ngModel",o.inputSearch),e.xp6(4),e.Q6J("ngIf",o.allbusiness.length))},dependencies:[c.sg,c.O5,d.JJ,d.On,s.oU,s.YG,s.Sm,s.PM,s.wI,s.W2,s.jY,s.Gu,s.pK,s.Ie,s.Q$,s.Nd,s.t9,s.n0,s.wd,s.sr,s.QI,s.j9,s.cs],styles:[".ion-margin[_ngcontent-%COMP%]{--ion-grid-column-padding: 10px;border-collapse:collapse;border-style:hidden}.ion-margin[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]:first-child{font-weight:700}.ion-margin[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{border:1px solid black;border-bottom:0;border-right:0}.ion-margin[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]:last-child{border-right:1px solid black}.ion-margin[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]:last-child{border-bottom:1px solid black}.btnStyle[_ngcontent-%COMP%]{text-align:center}.btnStyleIn[_ngcontent-%COMP%]{--border-radius: 50%}"]}),a})()}];let y=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[u.Bz.forChild(f),u.Bz]}),a})(),P=(()=>{class a{}return a.\u0275fac=function(t){return new(t||a)},a.\u0275mod=e.oAB({type:a}),a.\u0275inj=e.cJS({imports:[c.ez,d.u5,s.Pc,y]}),a})()}}]);