{"version":3,"file":"src_app_salesdata_salesdata_module_ts.js","mappings":"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","sources":["./src/app/salesdata/salesdata-routing.module.ts","./src/app/salesdata/salesdata.module.ts","./src/app/salesdata/salesdata.page.ts"],"sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { SalesdataPage } from './salesdata.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: SalesdataPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class SalesdataPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { SalesdataPageRoutingModule } from './salesdata-routing.module';\n\nimport { SalesdataPage } from './salesdata.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    SalesdataPageRoutingModule\n  ],\n  declarations: [SalesdataPage]\n})\nexport class SalesdataPageModule {}\n","import { Component, OnInit } from '@angular/core';\nimport { AngularFirestore } from '@angular/fire/compat/firestore';\nimport { Router } from '@angular/router';\n\n@Component({\n  selector: 'app-salesdata',\n  templateUrl: './salesdata.page.html',\n  styleUrls: ['./salesdata.page.scss'],\n})\nexport class SalesdataPage implements OnInit {\n  reportData: any;\n  downloaddata: any=[];\n  years: any =[];\n  allbusiness: any = [];\n  allBusinessSearch: any = [];\n  selectedDate: any = '';\n  inputLanNo: any = '';\n  custName: any = '';\n  inputSearch: any = '';\n\n  constructor(public firestore:AngularFirestore,public router:Router) { }\n\n  ngOnInit() {\n  }\n\n async ionViewWillEnter(){\n    await this.firestore.collection(\"dropdown\").doc('yearmonth').get().subscribe((doc:any)=>{\n      console.log(doc.data().yearmonth);\n      this.years = doc.data().yearmonth;\n     })\n     this.allbusiness = [];\n    if(JSON.parse(localStorage.userData)['role'] == 'subagent'){\n    await this.firestore.collection(\"business\", ref => ref.where('createdBy', \"==\", JSON.parse(localStorage.userData)['email'])).get().subscribe((doc:any)=>{\n       console.log(\"all docs here\");      \n       console.log(doc);\n       doc.docs.forEach((snapDoc)=>{\n         console.log(snapDoc.data());\n         var temp:any = snapDoc.data();\n         console.log(temp);\n         temp.id = snapDoc.id;\n         this.allbusiness.push(temp);\n         this.allBusinessSearch.push(temp);\n       })\n      })\n    }\n    else{\n      await this.firestore.collection(\"business\", ref => ref.where('agent', \"==\", JSON.parse(localStorage.userData)['email'])).get().subscribe((doc:any)=>{\n        console.log(\"all docs here\");      \n        console.log(doc);\n        doc.docs.forEach((snapDoc)=>{\n          console.log(snapDoc.data());\n          var temp:any = snapDoc.data();\n          console.log(temp);\n          temp.id = snapDoc.id;\n          this.allbusiness.push(temp);\n          this.allBusinessSearch.push(temp);\n        })\n       })\n    }\n  }\n\n\n  searchBusiness(){\n    this.inputSearch\n    this.allbusiness = this.allBusinessSearch.filter((user:any)=>{\n      if((user.name.toString()).includes(this.inputSearch)){\n        return user;\n      }else if((user.lanNo.toString()).includes(this.inputSearch.toString())){\n        return user;\n      }});\n  }\n\n  async exportReport(){\n\n    // await this.firestore.collection(\"business\", ref => ref.where('createdBy', \"==\", JSON.parse(localStorage.userData)['email'])).get().subscribe((doc:any)=>{ \n    //    this.reportData = doc.docs;\n       this.allbusiness.forEach((row) => {\n       \n       this.downloaddata.push({\n         \"Business Name\":row.name?row.name:'',\n         \"Lan Number\":row.lanNo?row.lanNo:'',\n         \"Created By Email\":row.createdBy?row.createdBy:'',\n         \"Created By Name\":row.createdByName?row.createdByName:'',\n         \"Disbused Amount\":row.disbursedAmount?row.disbursedAmount:'',\n         \"Disbused Date\":row.disburseDate?row.disburseDate:'',\n         \"QC Status\":row.approvedbyadmin == 'R'?'Reject':row.approvedbyadmin == 'P'?'Pending':row.approvedbyadmin == 'H'?'Hold':row.approvedbyadmin == 'Paid'?'Paid':'NA',\n         \"Agent Paymet\":row.amountToPayAgent?row.amountToPayAgent:'',\n         \"Sub Agent Payment\":row.amountToPaySubAgent?row.amountToPaySubAgent:''\n }) \n       })\n       const csvData = this.objectToCsv(this.downloaddata);\n       console.log(csvData);\n       \n     this.download(csvData);\n     \n    // })\n \n     \n \n     //  const downloaddata = this.reportData.map(row => ({\n     //   Data:'yes'\n     // }))\n     \n   }\n \n   objectToCsv(data) {\n     if (data.length != 0) {\n       const CsvRows = []\n       //get header\n       const headers = Object.keys(data[0]);\n       CsvRows.push(headers.join(','));\n       for (const row of data) {\n         const values = headers.map(header => {\n           const escaped = ('' + row[header]).replace(/\"/g, '\\\\\"');\n           return `\"${escaped}\"`;\n         })\n         CsvRows.push(values.join(','))\n       }\n       return CsvRows.join('\\n');\n     } else {\n       alert(\"No Data Found\")\n       return\n     }\n   }\n \n   download(data) {\n     console.log(data);\n     \n     const blob = new Blob([data], { type: 'text/csv' });\n     const url = window.URL.createObjectURL(blob);\n     const a = document.createElement('a');\n     a.setAttribute('hidden', '');\n     a.setAttribute('href', url);\n     a.setAttribute('download', 'download.csv');\n     document.body.appendChild(a);\n     a.click();\n     document.body.removeChild(a);\n   }\n}\n"],"names":["Component","AngularFirestore","Router","SalesdataPage","constructor","firestore","router","ngOnInit","ionViewWillEnter","collection","doc","get","subscribe","console","log","data","yearmonth","years","allbusiness","JSON","parse","localStorage","userData","ref","where","docs","forEach","snapDoc","temp","id","push","allBusinessSearch","searchBusiness","inputSearch","filter","user","name","toString","includes","lanNo","exportReport","row","downloaddata","createdBy","createdByName","disbursedAmount","disburseDate","approvedbyadmin","amountToPayAgent","amountToPaySubAgent","csvData","objectToCsv","download","length","CsvRows","headers","Object","keys","join","values","map","header","escaped","replace","alert","blob","Blob","type","url","window","URL","createObjectURL","a","document","createElement","setAttribute","body","appendChild","click","removeChild","selector","template"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}